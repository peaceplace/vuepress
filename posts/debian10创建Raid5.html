<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Debian10.x搭建Raid5磁盘阵列 | Mr.Pony</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/peaceplace/CDN/img/20200810210800.png">
    <meta name="description" content="Ma GX's BLOG">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" conetent="M-GX">
    <meta name="twitter:creator" conetent="@M-GX">
    
    <link rel="preload" href="/vuepress/assets/css/1.styles.ebcc2cbf.css" as="style"><link rel="preload" href="/vuepress/assets/js/app.d3d36a30.js" as="script"><link rel="preload" href="/vuepress/assets/js/15.9c4dc1e6.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/10.9de496ad.js"><link rel="prefetch" href="/vuepress/assets/js/11.030cd966.js"><link rel="prefetch" href="/vuepress/assets/js/12.0c983a7c.js"><link rel="prefetch" href="/vuepress/assets/js/13.aefb4e98.js"><link rel="prefetch" href="/vuepress/assets/js/14.9ae855b0.js"><link rel="prefetch" href="/vuepress/assets/js/16.403eeedc.js"><link rel="prefetch" href="/vuepress/assets/js/17.e8445936.js"><link rel="prefetch" href="/vuepress/assets/js/18.b55515a4.js"><link rel="prefetch" href="/vuepress/assets/js/19.3b8c63bc.js"><link rel="prefetch" href="/vuepress/assets/js/2.784113bb.js"><link rel="prefetch" href="/vuepress/assets/js/20.1942e16b.js"><link rel="prefetch" href="/vuepress/assets/js/21.bbb06709.js"><link rel="prefetch" href="/vuepress/assets/js/22.51282bcc.js"><link rel="prefetch" href="/vuepress/assets/js/23.cf1f8cb3.js"><link rel="prefetch" href="/vuepress/assets/js/24.e7c5815b.js"><link rel="prefetch" href="/vuepress/assets/js/25.aa91e0a3.js"><link rel="prefetch" href="/vuepress/assets/js/26.8797f464.js"><link rel="prefetch" href="/vuepress/assets/js/27.3fc07a66.js"><link rel="prefetch" href="/vuepress/assets/js/3.8c02ef1f.js"><link rel="prefetch" href="/vuepress/assets/js/4.4937812c.js"><link rel="prefetch" href="/vuepress/assets/js/5.f9c52789.js"><link rel="prefetch" href="/vuepress/assets/js/6.876139d0.js"><link rel="prefetch" href="/vuepress/assets/js/7.861c11da.js"><link rel="prefetch" href="/vuepress/assets/js/8.5c4475b0.js"><link rel="prefetch" href="/vuepress/assets/js/9.77055eee.js">
    <link rel="stylesheet" href="/vuepress/assets/css/1.styles.ebcc2cbf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><span><div id="sidebar" data-v-6e67c360><div class="PC-sidebar" data-v-6e67c360><div class="title" data-v-6e67c360>
            @<span data-v-6e67c360>Mr.Pony</span></div> <a href="/vuepress/" class="router-link-active bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home" data-v-7201a518><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" data-v-7201a518></path> <polyline points="9 22 9 12 15 12 15 22" data-v-7201a518></polyline></svg> <!----> <!----></div> <div class="name" data-v-7201a518>Home</div></a> <a href="/vuepress/archive" class="bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><!----> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book" data-v-7201a518><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" data-v-7201a518></path> <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" data-v-7201a518></path></svg> <!----></div> <div class="name" data-v-7201a518>Archive</div></a> <a href="/vuepress/about/" class="bar-button" data-v-7201a518 data-v-6e67c360><div class="svg" data-v-7201a518><!----> <!----> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user" data-v-7201a518><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" data-v-7201a518></path> <circle cx="12" cy="7" r="4" data-v-7201a518></circle></svg></div> <div class="name" data-v-7201a518>About</div></a></div> <!----></div><div class="main"><div class="wrap" data-v-5d573f62><div class="post" data-v-5d573f62><div class="title" data-v-5d573f62><h1 data-v-5d573f62>Debian10.x搭建Raid5磁盘阵列</h1></div> <div class="info" data-v-5d573f62><div class="date" data-v-382026d3 data-v-5d573f62><div class="svg" data-v-382026d3><svg t="1610177893433" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5858" width="16" height="16" class="icon" data-v-382026d3><path d="M512 192c179.2 0 320 140.8 320 320s-140.8 320-320 320-320-140.8-320-320S332.8 192 512 192M512 128C300.8 128 128 300.8 128 512s172.8 384 384 384 384-172.8 384-384S723.2 128 512 128L512 128z" p-id="5859" fill="#707070" data-v-382026d3></path> <path d="M640 672c-6.4 0-19.2 0-25.6-6.4l-128-128C486.4 531.2 480 518.4 480 512L480 288C480 268.8 492.8 256 512 256s32 12.8 32 32l0 211.2 121.6 121.6c12.8 12.8 12.8 32 0 44.8C659.2 672 646.4 672 640 672z" p-id="5860" fill="#707070" data-v-382026d3></path></svg></div> <div class="content" data-v-382026d3>2021/1/16</div></div> <div class="category" data-v-a6fce850 data-v-5d573f62><div class="svg" data-v-a6fce850><svg t="1610177808699" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4460" width="16" height="16" class="icon" data-v-a6fce850><path d="M725.290667 725.290667m-213.333334 0a213.333333 213.333333 0 1 0 426.666667 0 213.333333 213.333333 0 1 0-426.666667 0Z" p-id="4461" fill="#707070" data-v-a6fce850></path> <path d="M789.205333 234.794667m-149.333333 0a149.333333 149.333333 0 1 0 298.666667 0 149.333333 149.333333 0 1 0-298.666667 0Z" p-id="4462" fill="#707070" data-v-a6fce850></path> <path d="M235.861333 788.138667m-149.333333 0a149.333333 149.333333 0 1 0 298.666667 0 149.333333 149.333333 0 1 0-298.666667 0Z" p-id="4463" fill="#707070" data-v-a6fce850></path> <path d="M298.709333 298.709333m-213.333333 0a213.333333 213.333333 0 1 0 426.666667 0 213.333333 213.333333 0 1 0-426.666667 0Z" p-id="4464" fill="#707070" data-v-a6fce850></path></svg></div> <div class="content" data-v-a6fce850>教程</div></div> <div class="tags" data-v-2ed44237 data-v-5d573f62><div class="svg" data-v-2ed44237><svg t="1610177743508" viewBox="0 0 1085 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2934" width="16" height="16" class="icon" data-v-2ed44237><path d="M256 256q0-30.285714-21.428571-51.714286T182.857143 182.857143t-51.714286 21.428571T109.714286 256t21.428571 51.714286T182.857143 329.142857t51.714286-21.428571T256 256z m609.714286 329.142857q0 30.285714-21.142857 51.428572l-280.571429 281.142857q-22.285714 21.142857-52 21.142857-30.285714 0-51.428571-21.142857L52 508.571429q-21.714286-21.142857-36.857143-57.714286T0 384V146.285714q0-29.714286 21.714286-51.428571t51.428571-21.714286h237.714286q30.285714 0 66.857143 15.142857T436 125.142857l408.571429 408q21.142857 22.285714 21.142857 52z m219.428571 0q0 30.285714-21.142857 51.428572l-280.571429 281.142857q-22.285714 21.142857-52 21.142857-20.571429 0-33.714285-8t-30.285715-25.714286l268.571429-268.571428q21.142857-21.142857 21.142857-51.428572 0-29.714286-21.142857-52L527.428571 125.142857q-21.714286-21.714286-58.285714-36.857143T402.285714 73.142857h128q30.285714 0 66.857143 15.142857t58.285714 36.857143l408.571429 408q21.142857 22.285714 21.142857 52z" p-id="2935" fill="#8a8a8a" data-v-2ed44237></path></svg></div> <div class="content" data-v-2ed44237><span class="tag" style="color:#2374AB;" data-v-2ed44237>
            Raid5
        </span><span class="tag" style="color:#00BCD4;" data-v-2ed44237>
            高职院校技能大赛
        </span><span class="tag" style="color:#5EA2DD;" data-v-2ed44237>
            debian
        </span></div></div></div> <div class="line" data-v-5d573f62></div> <div class="content" data-v-5d573f62><div class="content__default" data-v-5d573f62><p>技术简介</p> <p>RAID5技术是把硬盘设备的数据奇偶校验信息保存到其他硬盘设备中。RAID 5磁盘阵列组中数据的奇偶校验信息并不是单独保存到某一块硬盘设备中，而是存储到除自身以外的其他每一块硬盘设备上，这样的好处是其中任何一设备损坏后不至于出现致命缺陷；换句话说，就是RAID 5技术实际上没有备份硬盘中的真实数据信息，而是当硬盘设备出现问题后通过奇偶校验信息来尝试重建损坏的数据。RAID这样的技术特性“妥协”地兼顾了硬盘设备的读写速度、数据安全性与存储成本问题
</p> <h2 id="实施方法"><a href="#实施方法" class="header-anchor">#</a> 实施方法</h2> <blockquote><p>假设企业需求:</p> <blockquote><p>•	在虚拟机上添加 4 个 1G 的硬盘；<br>
• 创建 raid5，其中一个作为热备盘, 设备名为md0;<br>
• 将 md0 设置为 LVM，设备为/dev/vg01/lv01；<br>
• 格式化为 ext4 文件系统;<br>
• 开机自动挂载到/data 目录</p></blockquote></blockquote> <h3 id="环境创建"><a href="#环境创建" class="header-anchor">#</a> 环境创建</h3> <h4 id="虚拟机上添加四块1g硬盘"><a href="#虚拟机上添加四块1g硬盘" class="header-anchor">#</a> 虚拟机上添加四块1G硬盘</h4> <p><img src="https://img-blog.csdnimg.cn/img_convert/1fdd2f312ca7425da2902964d2bb156c.png" alt=""></p> <h4 id="在系统上查看硬盘是否存在以及对应硬盘名"><a href="#在系统上查看硬盘是否存在以及对应硬盘名" class="header-anchor">#</a> 在系统上查看硬盘是否存在以及对应硬盘名</h4> <div class="language-Linux extra-class"><pre class="language-text"><code>root@Server01:~# lsblk
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/img_convert/54431d1e0a9f637641a7b9b8be81b1d4.png" alt=""></p> <h4 id="安装mdadm"><a href="#安装mdadm" class="header-anchor">#</a> 安装mdadm</h4> <div class="language-Linux extra-class"><pre class="language-text"><code>root@Server01:~# apt install -y mdadm
</code></pre></div><h4 id="使用mdadm命令创建raid5"><a href="#使用mdadm命令创建raid5" class="header-anchor">#</a> 使用mdadm命令创建raid5</h4> <div class="language-Linux extra-class"><pre class="language-text"><code>root@Server01:~# mdadm -Cv /dev/md0 -n 3 -l 5 -x 1 /dev/sd[b-e]
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/img_convert/780aaf0146bd51a0150997781e33159b.png" alt=""></p> <center><strong>mdadm命令的常用参数和作用</strong></center> <table><thead><tr><th style="text-align:center;">参数</th> <th style="text-align:center;">作用</th></tr></thead> <tbody><tr><td style="text-align:center;">-a</td> <td style="text-align:center;">检测设备名称</td></tr> <tr><td style="text-align:center;">-n</td> <td style="text-align:center;">指定设备数量</td></tr> <tr><td style="text-align:center;">-l</td> <td style="text-align:center;">指定RAID级别</td></tr> <tr><td style="text-align:center;">-C</td> <td style="text-align:center;">创建</td></tr> <tr><td style="text-align:center;">-v</td> <td style="text-align:center;">显示过程</td></tr> <tr><td style="text-align:center;">-f</td> <td style="text-align:center;">模拟设备损坏</td></tr> <tr><td style="text-align:center;">-r</td> <td style="text-align:center;">移除设备</td></tr> <tr><td style="text-align:center;">-Q</td> <td style="text-align:center;">查看摘要信息</td></tr> <tr><td style="text-align:center;">-D</td> <td style="text-align:center;">查看详细信息</td></tr> <tr><td style="text-align:center;">-S</td> <td style="text-align:center;">停止RAID磁盘阵列</td></tr></tbody></table> <blockquote><p>根据常用参数解释命令则为：创建/dev/md0阵列卡并显示过程，其中等级为5，硬盘数为3，热备盘数为1，硬盘设备为：/dev/sdb,sdc,sdd,sde</p></blockquote> <h4 id="将md0设置为lvm-逻辑卷管理器"><a href="#将md0设置为lvm-逻辑卷管理器" class="header-anchor">#</a> 将md0设置为lvm（逻辑卷管理器）</h4> <ul><li><p>首先安装lvm工具： <code>apt install -y lvm*</code></p></li> <li><p>添加硬盘使其支持LVM技术：<code>pvcreate /dev/md0</code></p></li></ul> <p><img src="https://img-blog.csdnimg.cn/img_convert/84f1aff1958013599aa6dababe3a741e.png" alt=""></p> <ul><li>将硬盘设备添加进vg01卷组：<code>vgcreate vg01 /dev/md0</code></li></ul> <p><img src="https://img-blog.csdnimg.cn/img_convert/c018d630ea8db8552b973c0167712a67.png" alt=""></p> <ul><li>切割逻辑卷设备，没要求大小则此处设置为1G： <code>lvcreate -n lv01 -L 1G vg01</code></li></ul> <p><img src="https://img-blog.csdnimg.cn/img_convert/01537136ee0ea0339a14e140c625bb16.png" alt=""></p> <ul><li>查看是否成功创建： <code>lvdisplay</code></li></ul> <p><img src="https://img-blog.csdnimg.cn/img_convert/97f60a8d29c182e011ec3584b0350932.png" alt=""></p> <h4 id="格式化磁盘为ext4格式"><a href="#格式化磁盘为ext4格式" class="header-anchor">#</a> 格式化磁盘为ext4格式</h4> <div class="language-Linux extra-class"><pre class="language-text"><code>root@Server01:~# mkfs.ext4 /dev/vg01/lv01
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/img_convert/3559a94d6714328f3efebb1d644ef7d5.png" alt=""></p> <h4 id="挂载磁盘分区到-data目录"><a href="#挂载磁盘分区到-data目录" class="header-anchor">#</a> 挂载磁盘分区到/data目录</h4> <div class="language-Linux extra-class"><pre class="language-text"><code>root@Server01:~# mkdir /data
root@Server01:~#  echo “/dev/vg01/lv01 /data ext4 defaults 0 0” &gt;&gt; /etc/fstab
root@Server01:~# mount -a
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/img_convert/c15c43574ae2bcec44208d529a18c7e3.png" alt=""></p> <h4 id="查看是否挂载成功"><a href="#查看是否挂载成功" class="header-anchor">#</a> 查看是否挂载成功</h4> <div class="language-Linux extra-class"><pre class="language-text"><code>root@Server01:~# df -Th
</code></pre></div><p><img src="https://img-blog.csdnimg.cn/img_convert/fa80e6e80cfdd9840c97209b97d3b904.png" alt=""></p></div></div> <div class="footer" data-v-5d573f62><div title="share this post" class="share share-icon" data-v-5d573f62><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share-2" data-v-5d573f62><circle cx="18" cy="5" r="3" data-v-5d573f62></circle><circle cx="6" cy="12" r="3" data-v-5d573f62></circle><circle cx="18" cy="19" r="3" data-v-5d573f62></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49" data-v-5d573f62></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49" data-v-5d573f62></line></svg> <path d="M896 469.333333l-298.666667-298.666667 0 170.666667C298.666667 384 170.666667 597.333333 128 810.666667c106.666667-149.333333 256-217.6 469.333333-217.6L597.333333 768 896 469.333333z" p-id="7022" fill="#1296db" data-v-5d573f62></path></div> <div class="share" data-v-5d573f62><!----></div> <div class="share" data-v-5d573f62><!----></div></div></div> <div class="footer" data-v-882df4f6 data-v-5d573f62><footer data-v-882df4f6><div data-v-882df4f6>
            © 2020 -
            2021
            <svg viewBox="64 64 896 896" data-icon="flag" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" data-v-882df4f6><path fill="#1296db" d="M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32z" data-v-882df4f6></path></svg>
            @M-GX
        </div> <div data-v-882df4f6>
            Based on the
            <a href="https://vuepress.vuejs.org/" target="_blank" data-v-882df4f6>VuePress Powered</a>
            &amp;
            <a href="https://github.com/korilin/vuepress-theme-twipress" target="_blank" data-v-882df4f6>Twipress Theme</a></div> <div data-v-882df4f6>
            备案号：<a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/" data-v-882df4f6>
                陕ICP备2020013675号
            </a></div></footer></div></div></div><div id="toolbar" data-v-fe84d7a0><!----> <div class="toolbar" data-v-fe84d7a0><div class="search" data-v-fe84d7a0><div class="search-box" data-v-fe84d7a0><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="post-sort" data-v-fe84d7a0><div class="title" data-v-fe84d7a0>Post Order</div> <div class="op" data-v-fe84d7a0>
                By Time
                <svg t="1610607067172" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2795" width="20" height="20" class="icon" style="display:;" data-v-fe84d7a0><path d="M495.765247 353.091804 333.414649 190.741205 171.065074 353.091804 304.386522 353.091804l0 420.142919c0 17.947767 14.046924 32.469506 31.978319 32.469506 17.931395 0 31.978319-14.522762 31.978319-32.469506L368.343159 353.091804 495.765247 353.091804z" p-id="2796" data-v-fe84d7a0></path> <path d="M720.104665 672.874991 720.104665 221.24494c0-17.947767-14.046924-32.469506-31.978319-32.469506s-31.978319 14.522762-31.978319 32.469506l0 451.630051-127.913275 0 162.349575 162.349575 162.349575-162.349575L720.104665 672.874991z" p-id="2797" data-spm-anchor-id="a313x.7781069.0.i7" fill="#1296db" class="selected" data-v-fe84d7a0></path></svg> <svg t="1610612746140" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2973" width="20" height="20" class="icon" style="display:none;" data-v-fe84d7a0><path d="M495.765247 353.091804 333.414649 190.741205 171.065074 353.091804 304.386522 353.091804l0 420.142919c0 17.947767 14.046924 32.469506 31.978319 32.469506 17.931395 0 31.978319-14.522762 31.978319-32.469506L368.343159 353.091804 495.765247 353.091804z" p-id="2974" data-spm-anchor-id="a313x.7781069.0.i9" fill="#1296db" class="selected" data-v-fe84d7a0></path> <path d="M720.104665 672.874991 720.104665 221.24494c0-17.947767-14.046924-32.469506-31.978319-32.469506s-31.978319 14.522762-31.978319 32.469506l0 451.630051-127.913275 0 162.349575 162.349575 162.349575-162.349575L720.104665 672.874991z" p-id="2975" data-v-fe84d7a0></path></svg>
                :
                <span class="content" data-v-fe84d7a0>DESC</span></div></div> <div class="statistics" data-v-fe84d7a0><div class="title" data-v-fe84d7a0>Article Statistics</div> <div class="data" data-v-fe84d7a0>
                Article: 24
            </div> <div class="data" data-v-fe84d7a0>
                Categories: 6
            </div> <div class="data" data-v-fe84d7a0>
                Tags: 53
            </div> <div class="more" data-v-fe84d7a0><a href="/vuepress/archive" data-v-fe84d7a0>see more</a></div></div></div></div></span></div><div class="global-ui"></div></div>
    <script src="/vuepress/assets/js/app.d3d36a30.js" defer></script><script src="/vuepress/assets/js/15.9c4dc1e6.js" defer></script>
  </body>
</html>
